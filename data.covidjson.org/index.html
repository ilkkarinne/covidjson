<html xmlns="http://www.w3.org/1999/xhtml" >
<head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width,maximum-scale=2">
    <link rel="stylesheet" href="https://covidjson.org/assets/css/style.css"/>
    <title>CovidJSON.org Public Datasets</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-sparklines/2.1.2/jquery.sparkline.min.js"></script>
    <style>
    #map_container {
      width: 100%;
      height: 600px;
      display: flex;
    }
    #map {
      height: 100%;
      flex: 0 0 45%; 
    }

    #info {
      padding-left: 10px;
      font-size: smaller;
      height: 100%;
      width: 100%; 
      flex: 1;
      border-width: 1px;
      border-color: black;
    }

    #info table {
      table-layout: fixed;
    }

    #info table tr td:nth-child(1) {
      white-space: nowrap;
    }

    #info table tr td:nth-child(2) {
      width: 99%;
    }
  </style>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-21595267-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-21595267-13');
  </script>
  <script>
    var map;

    function initMap() {
      var infowindow = new google.maps.InfoWindow();
      map = new google.maps.Map(document.getElementById('map'), {
        zoom: 5,
        center: {lat: 65.5538179, lng: 25.7496755}
      });

      map.data.setStyle({
        fillColor: 'blue',
        strokeWeight: 1
      });

      map.data.addListener('mouseover', function(event) {
        map.data.revertStyle();
        map.data.overrideStyle(event.feature, {fillColor: 'red'});
          event.feature.forEachProperty(function(value, key) {
            var fieldElement = document.getElementById(key);
            if (fieldElement != null) {
              if (fieldElement.tagName === 'A') {
                fieldElement.setAttribute('href', value);
              }
              fieldElement.textContent = value;

              if (key === 'result' && Array.isArray(value)) {
                $('#' + key).sparkline('html', {type: 'bar'});
              }
            }
          });
      });

      loadDataset('fin_totalInfectionsByHealthCareDistrict');
    }

    function loadDataset(name) {
      map.data.forEach(function (feature) {
        map.data.remove(feature);
      });
      map.data.loadGeoJson('/' + name + '.geojson');
    }

  </script>
</head>
<body>
    <div id="header_wrap" class="outer">
        <header class="inner">
          <a id="forkme_banner" href="https://github.com/ilkkarinne/covidjson">View on GitHub</a>

          <h1 id="project_title"><a href="https://covidjson.org/">CovidJSON</a> Data</h1>
          
        </header>
    </div>

    <!-- MAIN CONTENT -->
    <div id="main_content_wrap" class="outer">
      <section id="main_content" class="inner">
        <p>As a live examples of using CovidJSON for SARS-Cov-2 test data, the data sets listed below are currently being made available at this site.
            The data used is extracted directly from the
            <a href="https://w3qa5ydb4l.execute-api.eu-west-1.amazonaws.com/prod/processedThlData">
            Finnish coronavirus data API</a> provided by <a href="https://github.com/HS-Datadesk/koronavirus-avoindata">Helsingin Sanomat Datadesk</a> based on original data from 
            <a href="https://thl.fi/fi/tilastot-ja-data/aineistot-ja-palvelut/avoin-data/varmistetut-koronatapaukset-suomessa-covid-19-">THL</a>.
          
            <p>See <a href="https://covidjson.org/">CovidJSON main page</a> for information on the initiative and the date model.</p>
          
            <p>A really basic map just to demo showing the data:</p>
            <form>
              <label for="dataset">Choose a dataset:</label>
              <select id="dataset_select" name="dataset" onchange="loadDataset(this.options[this.selectedIndex].value)">
                <option value="fin_totalInfectionsByHealthCareDistrict">Total infection count</option>
                <option value="fin_newInfectionsTimeseriesByHealthCareDistrict">Daily timeseries</option>
              </select>
            </form>
            <div id="map_container">
              <div id="map"></div>
              <div id="info">
                <table>
                    <tr><td class="field_name">featureType</td><td class="field_value" id="featureType"></td></tr>
                    <tr><td class="field_name">ultimateFeatureOfInterestName</td><td class="field_value" id="ultimateFeatureOfInterestName"></td></tr>
                    <tr><td class="field_name">phenomenonTimeStart</td><td class="field_value" id="phenomenonTimeStart"></td></tr>
                    <tr><td class="field_name">phenomenonTimeEnd</td><td class="field_value" id="phenomenonTimeEnd"></td></tr>
                    <tr><td class="field_name">procedureName</td><td class="field_value" id="procedureName"></td></tr>
                    <tr><td class="field_name">procedureReference</td><td class="field_value"><a href="" id="procedureReference"></a></td></tr>
                    <tr><td class="field_name">observedPropertyTitle</td><td class="field_value" id="observedPropertyTitle"></td></tr>
                    <tr><td class="field_name">observedProperty</td><td class="field_value"><a href="" id="observedProperty"></a></td></tr>
                    <tr><td class="field_name">observerName</td><td class="field_value" id="observerName"></td></tr>
                    <tr><td class="field_name">resultTime</td><td class="field_value" id="resultTime"></td></tr>
                    <tr><td class="field_name">result</td><td class="field_value" id="result"></td></tr>
                </table>
              </div>
            </div>
            
            <p>Datasets for download:
                <ul>
                <li>Cumulative total verified SARS-CoV-2 infection number by Finnish healthcare district: <a href="/fin_totalInfectionsByHealthCareDistrict.geojson">fin_totalInfectionsByHealthCareDistrict.geojson</a></li>
                <li>Timeseries of daily new verified SARS-CoV-2 infections by Finnish healthcare district: <a href="/fin_newInfectionsTimeseriesByHealthCareDistrict.geojson">fin_newInfectionsTimeseriesByHealthCareDistrict.geojson</a></li>
                </ul>
            </p>

            <p>CovidJSON data model and data conversion by Ilkka Rinne / Spatineo. Data conversion code based on the following remarkable work:
                <ul>
                    <li><a href="https://ngageoint.github.io/simple-features-geojson-java/">Simple Features GeoJSON Java</a> by the <a href="https://github.com/ngageoint">National Geospatial-Intelligence Agency</a></li>
                    <li><a href="https://github.com/VuokkoH/koronavirus-avoindata">Health care district polygons in Finland</a> by <a href="https://github.com/VuokkoH">Vuokko Heikinheimo</a></li>
                </ul>
            </p>
            
            <script async defer
            src="https://maps.googleapis.com/maps/api/js?key=AIzaSyCCLQYLL6yjzHjamp4uyz5mLJlmmhi_rrQ&callback=initMap">
            </script>
      </section>
    </div>
  </body>
</html>